function googleError(){alert("cannot load Google Map")}function loadMarkers(){var e=new google.maps.LatLngBounds;markers().forEach(function(n){n.setMap(map),e.extend(n.position)}),map.fitBounds(e)}function getAllMarkers(e){for(var n=0;n<e.length;n++){var t=e[n].location,o=e[n].title,a=e[n].genre,i=e[n].ajaxContent=ko.observable("pending search..."),r=new google.maps.Marker({position:t,title:o,genre:a,ajaxContent:i,animation:google.maps.Animation.DROP,id:n});infowindow=new google.maps.InfoWindow,markers.push(r),r.addListener("click",function(){getFS(this),populateInfoWindow(this,infowindow),toggleBounce(this)})}}function getFS(e){var n="https://api.foursquare.com/v2/venues/explore",t="CAD3EEXMNHQFJ4HD215D4EA0KB10WHQGXSRQCV2LFOGFSFCF",o="WN4UXNSSMR25SNOMT5VCEBWVVONFQ4HUBGQZZ3DLDI1T5O5F";$.ajax({url:n,dataType:"json",data:"limit=1&ll="+e.position.lat()+","+e.position.lng()+"&query="+e.title+"&client_id="+t+"&client_secret="+o+"&v=20161106&m=foursquare",method:"GET",async:!0}).done(function(n){e.rating=n.response.groups[0].items[0].venue.rating,e.rating||(e.rating="No rating in foursquare");var t='<br><div class="labels"><div class="title">'+e.title+'</div><div class="rating">Foursquare rating: '+e.rating+"</div></div>";e.ajaxContent(t)}).fail(function(e){alert("Could not load data from foursquare!")})}function toggleBounce(e){null!==e.getAnimation()?e.setAnimation(null):(e.setAnimation(google.maps.Animation.BOUNCE),setTimeout(function(){e.setAnimation(null)},700))}function populateInfoWindow(e,n){n.marker!=e&&(n.marker=e,n.setContent("<div>"+e.ajaxContent()+"</div>"),n.open(map,e),n.addListener("closeclick",function(){n.marker=null}))}function ViewModel(){var e=this;e.list=ko.observableArray(dataArray),e.currentFilter=ko.observable(),e.filters=ko.observableArray([0,1]),e.filter=ko.observable(""),e.locationSelect=function(e){google.maps.event.trigger(e,"click")},e.filteredItems=ko.computed(function(){var n=e.filter();return n&&0!==n?ko.utils.arrayFilter(markers(),function(e){var t=e.genre==n;return e.setVisible(t),infowindow&&infowindow.close(),t}):(markers().forEach(function(e){e.setVisible(!0)}),markers())})}var dataArray=[{title:"Park Ave Penthouse",location:{lat:40.7713024,lng:-73.9632393},genre:"1"},{title:"Chelsea Loft",location:{lat:40.7444883,lng:-73.9949465},genre:"0"},{title:"Union Square Open Floor Plan",location:{lat:40.7347062,lng:-73.9895759},genre:"1"},{title:"East Village Hip Studio",location:{lat:40.7281777,lng:-73.984377},genre:"0"},{title:"TriBeCa Artsy Bachelor Pad",location:{lat:40.7195264,lng:-74.0089934},genre:"1"},{title:"Chinatown Homey Space",location:{lat:40.7180628,lng:-73.9961237},genre:"0"}],map,markers=ko.observableArray(),infowindow;initMap=function(){map=new google.maps.Map(document.getElementById("map"),{center:{lat:40.7413549,lng:-73.9980244},zoom:13});new google.maps.LatLngBounds;getAllMarkers(dataArray),loadMarkers()},ko.applyBindings(new ViewModel);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1hcC5qcyIsInZpZXdtb2RlbC5qcyIsImRhdGFBcnJheS5qcyJdLCJuYW1lcyI6WyJnb29nbGVFcnJvciIsImFsZXJ0IiwibG9hZE1hcmtlcnMiLCJib3VuZHMiLCJnb29nbGUiLCJtYXBzIiwiTGF0TG5nQm91bmRzIiwibWFya2VycyIsImZvckVhY2giLCJtYXJrZXIiLCJzZXRNYXAiLCJtYXAiLCJleHRlbmQiLCJwb3NpdGlvbiIsImZpdEJvdW5kcyIsImdldEFsbE1hcmtlcnMiLCJsb2NhdGlvbnMiLCJpIiwibGVuZ3RoIiwibG9jYXRpb24iLCJ0aXRsZSIsImdlbnJlIiwiY29udGVudCIsImFqYXhDb250ZW50Iiwia28iLCJvYnNlcnZhYmxlIiwiTWFya2VyIiwiYW5pbWF0aW9uIiwiQW5pbWF0aW9uIiwiRFJPUCIsImlkIiwiaW5mb3dpbmRvdyIsIkluZm9XaW5kb3ciLCJwdXNoIiwiYWRkTGlzdGVuZXIiLCJnZXRGUyIsInRoaXMiLCJwb3B1bGF0ZUluZm9XaW5kb3ciLCJ0b2dnbGVCb3VuY2UiLCJ1cmwiLCJpZEZTcSIsInNlY3JldEZzcSIsIiQiLCJhamF4IiwiZGF0YVR5cGUiLCJkYXRhIiwibGF0IiwibG5nIiwibWV0aG9kIiwiYXN5bmMiLCJkb25lIiwicmVzdWx0IiwicmF0aW5nIiwicmVzcG9uc2UiLCJncm91cHMiLCJpdGVtcyIsInZlbnVlIiwiZmFpbCIsImVyciIsImdldEFuaW1hdGlvbiIsInNldEFuaW1hdGlvbiIsIkJPVU5DRSIsInNldFRpbWVvdXQiLCJzZXRDb250ZW50Iiwib3BlbiIsIlZpZXdNb2RlbCIsInNlbGYiLCJsaXN0Iiwib2JzZXJ2YWJsZUFycmF5IiwiZGF0YUFycmF5IiwiY3VycmVudEZpbHRlciIsImZpbHRlcnMiLCJmaWx0ZXIiLCJsb2NhdGlvblNlbGVjdCIsImxvYyIsImV2ZW50IiwidHJpZ2dlciIsImZpbHRlcmVkSXRlbXMiLCJjb21wdXRlZCIsInV0aWxzIiwiYXJyYXlGaWx0ZXIiLCJtYXRjaCIsInNldFZpc2libGUiLCJjbG9zZSIsImluaXRNYXAiLCJNYXAiLCJkb2N1bWVudCIsImdldEVsZW1lbnRCeUlkIiwiY2VudGVyIiwiem9vbSIsImFwcGx5QmluZGluZ3MiXSwibWFwcGluZ3MiOiJBQUFBLFFBQUFBLGVBQ0FDLE1BQUEsMEJBNEJBLFFBQUFDLGVBQ0EsR0FBQUMsR0FBQSxHQUFBQyxRQUFBQyxLQUFBQyxZQUVBQyxXQUFBQyxRQUFBLFNBQUFDLEdBQ0FBLEVBQUFDLE9BQUFDLEtBQ0FSLEVBQUFTLE9BQUFILEVBQUFJLFlBRUFGLElBQUFHLFVBQUFYLEdBSUEsUUFBQVksZUFBQUMsR0FDQSxJQUFBLEdBQUFDLEdBQUEsRUFBQUEsRUFBQUQsRUFBQUUsT0FBQUQsSUFBQSxDQUVBLEdBQUFKLEdBQUFHLEVBQUFDLEdBQUFFLFNBQ0FDLEVBQUFKLEVBQUFDLEdBQUFHLE1BQ0FDLEVBQUFMLEVBQUFDLEdBQUFJLE1BQ0FDLEVBQUFOLEVBQUFDLEdBQUFNLFlBQUFDLEdBQUFDLFdBQUEscUJBRUFoQixFQUFBLEdBQUFMLFFBQUFDLEtBQUFxQixRQUNBYixTQUFBQSxFQUNBTyxNQUFBQSxFQUNBQyxNQUFBQSxFQUNBRSxZQUFBRCxFQUNBSyxVQUFBdkIsT0FBQUMsS0FBQXVCLFVBQUFDLEtBQ0FDLEdBQUFiLEdBR0FjLFlBQUEsR0FBQTNCLFFBQUFDLEtBQUEyQixXQUdBekIsUUFBQTBCLEtBQUF4QixHQUVBQSxFQUFBeUIsWUFBQSxRQUFBLFdBQ0FDLE1BQUFDLE1BQ0FDLG1CQUFBRCxLQUFBTCxZQUNBTyxhQUFBRixTQVFBLFFBQUFELE9BQUExQixHQUVBLEdBQUE4QixHQUFBLCtDQUVBQyxFQUFBLG1EQUVBQyxFQUFBLGtEQUVBQyxHQUFBQyxNQUNBSixJQUFBQSxFQUNBSyxTQUFBLE9BQ0FDLEtBQUEsY0FBQXBDLEVBQUFJLFNBQUFpQyxNQUFBLElBQUFyQyxFQUFBSSxTQUFBa0MsTUFBQSxVQUFBdEMsRUFBQVcsTUFBQSxjQUFBb0IsRUFDQSxrQkFBQUMsRUFBQSwyQkFDQU8sT0FBQSxNQUNBQyxPQUFBLElBQ0FDLEtBQUEsU0FBQUMsR0FHQTFDLEVBQUEyQyxPQUFBRCxFQUFBRSxTQUFBQyxPQUFBLEdBQUFDLE1BQUEsR0FBQUMsTUFBQUosT0FFQTNDLEVBQUEyQyxTQUNBM0MsRUFBQTJDLE9BQUEsMEJBR0EsSUFBQTlCLEdBQUEsOENBQUFiLEVBQUFXLE1BQ0EsZ0RBQUFYLEVBQUEyQyxPQUFBLGNBQ0EzQyxHQUFBYyxZQUFBRCxLQUVBbUMsS0FBQSxTQUFBQyxHQUVBekQsTUFBQSwwQ0FRQSxRQUFBcUMsY0FBQTdCLEdBQ0EsT0FBQUEsRUFBQWtELGVBQ0FsRCxFQUFBbUQsYUFBQSxPQUVBbkQsRUFBQW1ELGFBQUF4RCxPQUFBQyxLQUFBdUIsVUFBQWlDLFFBQ0FDLFdBQUEsV0FDQXJELEVBQUFtRCxhQUFBLE9BQ0EsTUFNQSxRQUFBdkIsb0JBQUE1QixFQUFBc0IsR0FFQUEsRUFBQXRCLFFBQUFBLElBQ0FzQixFQUFBdEIsT0FBQUEsRUFDQXNCLEVBQUFnQyxXQUFBLFFBQUF0RCxFQUFBYyxjQUFBLFVBQ0FRLEVBQUFpQyxLQUFBckQsSUFBQUYsR0FFQXNCLEVBQUFHLFlBQUEsYUFBQSxXQUNBSCxFQUFBdEIsT0FBQSxRQ2xJQSxRQUFBd0QsYUFDQSxHQUFBQyxHQUFBOUIsSUFFQThCLEdBQUFDLEtBQUEzQyxHQUFBNEMsZ0JBQUFDLFdBQ0FILEVBQUFJLGNBQUE5QyxHQUFBQyxhQUNBeUMsRUFBQUssUUFBQS9DLEdBQUE0QyxpQkFBQSxFQUFBLElBQ0FGLEVBQUFNLE9BQUFoRCxHQUFBQyxXQUFBLElBRUF5QyxFQUFBTyxlQUFBLFNBQUFDLEdBQ0F0RSxPQUFBQyxLQUFBc0UsTUFBQUMsUUFBQUYsRUFBQSxVQUdBUixFQUFBVyxjQUFBckQsR0FBQXNELFNBQUEsV0FDQSxHQUFBTixHQUFBTixFQUFBTSxRQUNBLE9BQUFBLElBQUEsSUFBQUEsRUFTQWhELEdBQUF1RCxNQUFBQyxZQUFBekUsVUFBQSxTQUFBVSxHQUVBLEdBQUFnRSxHQUFBaEUsRUFBQUksT0FBQW1ELENBTUEsT0FMQXZELEdBQUFpRSxXQUFBRCxHQUVBbEQsWUFDQUEsV0FBQW9ELFFBRUFGLEtBZEExRSxVQUFBQyxRQUFBLFNBQUFDLEdBQ0FBLEVBQUF5RSxZQUFBLEtBRUEzRSxhQ3RCQSxHQUFBOEQsYUFDQWpELE1BQUEscUJBQ0FELFVBQ0EyQixJQUFBLFdBQ0FDLEtBQUEsWUFFQTFCLE1BQUEsTUFFQUQsTUFBQSxlQUNBRCxVQUNBMkIsSUFBQSxXQUNBQyxLQUFBLFlBRUExQixNQUFBLE1BRUFELE1BQUEsK0JBQ0FELFVBQ0EyQixJQUFBLFdBQ0FDLEtBQUEsWUFFQTFCLE1BQUEsTUFFQUQsTUFBQSwwQkFDQUQsVUFDQTJCLElBQUEsV0FDQUMsS0FBQSxXQUVBMUIsTUFBQSxNQUVBRCxNQUFBLDZCQUNBRCxVQUNBMkIsSUFBQSxXQUNBQyxLQUFBLFlBRUExQixNQUFBLE1BRUFELE1BQUEsd0JBQ0FELFVBQ0EyQixJQUFBLFdBQ0FDLEtBQUEsWUFFQTFCLE1BQUEsTUZyQ0FWLElBRUFKLFFBQUFpQixHQUFBNEMsa0JBRUFyQyxVQUVBcUQsU0FBQSxXQUdBekUsSUFBQSxHQUFBUCxRQUFBQyxLQUFBZ0YsSUFBQUMsU0FBQUMsZUFBQSxRQUNBQyxRQUNBMUMsSUFBQSxXQUNBQyxLQUFBLFlBRUEwQyxLQUFBLElBTUEsSUFBQXJGLFFBQUFDLEtBQUFDLFlBQ0FTLGVBQUFzRCxXQUNBbkUsZUNpQkFzQixHQUFBa0UsY0FBQSxHQUFBekIiLCJmaWxlIjoic2NyaXB0cy5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyJmdW5jdGlvbiBnb29nbGVFcnJvcigpIHtcbiAgICBhbGVydCgnY2Fubm90IGxvYWQgR29vZ2xlIE1hcCcpO1xufVxuLy8gQ3JlYXRlIGEgbWFwIHZhcmlhYmxlXG52YXIgbWFwO1xuLy8gQ3JlYXRlIGEgbmV3IGJsYW5rIGFycmF5IGZvciBhbGwgdGhlIGxpc3RpbmcgbWFya2Vycy5cbnZhciBtYXJrZXJzID0ga28ub2JzZXJ2YWJsZUFycmF5KCk7XG4vLyBDcmVhdGUgZ2xvYmFsIHZhciBmb3IgaW5mb3dpbmRvd1xudmFyIGluZm93aW5kb3c7XG5cbmluaXRNYXAgPSBmdW5jdGlvbigpIHtcblxuICAgIC8vIENvbnN0cnVjdG9yIGNyZWF0ZXMgYSBuZXcgbWFwIC0gb25seSBjZW50ZXIgYW5kIHpvb20gYXJlIHJlcXVpcmVkLlxuICAgIG1hcCA9IG5ldyBnb29nbGUubWFwcy5NYXAoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21hcCcpLCB7XG4gICAgICAgIGNlbnRlcjoge1xuICAgICAgICAgICAgbGF0OiA0MC43NDEzNTQ5LFxuICAgICAgICAgICAgbG5nOiAtNzMuOTk4MDI0NFxuICAgICAgICB9LFxuICAgICAgICB6b29tOiAxM1xuICAgIH0pO1xuICAgIC8vIFRoZXNlIGFyZSB0aGUgcmVhbCBlc3RhdGUgbGlzdGluZ3MgdGhhdCB3aWxsIGJlIHNob3duIHRvIHRoZSB1c2VyLlxuICAgIC8vIE5vcm1hbGx5IHdlJ2QgaGF2ZSB0aGVzZSBpbiBhIGRhdGFiYXNlIGluc3RlYWQuXG4gICAgLy92YXIgbGFyZ2VJbmZvd2luZG93ID0gbmV3IGdvb2dsZS5tYXBzLkluZm9XaW5kb3coKTtcblxuICAgIHZhciBib3VuZHMgPSBuZXcgZ29vZ2xlLm1hcHMuTGF0TG5nQm91bmRzKCk7XG4gICAgZ2V0QWxsTWFya2VycyhkYXRhQXJyYXkpO1xuICAgIGxvYWRNYXJrZXJzKCk7XG59O1xuLy8gVGhpcyBmdW5jdGlvbiB3aWxsIGxvb3AgdGhyb3VnaCB0aGUgbWFya2VycyBhcnJheSBhbmQgZGlzcGxheSB0aGVtIGFsbC5cbmZ1bmN0aW9uIGxvYWRNYXJrZXJzKCkge1xuICAgIHZhciBib3VuZHMgPSBuZXcgZ29vZ2xlLm1hcHMuTGF0TG5nQm91bmRzKCk7XG4gICAgLy8gRXh0ZW5kIHRoZSBib3VuZGFyaWVzIG9mIHRoZSBtYXAgZm9yIGVhY2ggbWFya2VyIGFuZCBkaXNwbGF5IHRoZSBtYXJrZXJcbiAgICBtYXJrZXJzKCkuZm9yRWFjaChmdW5jdGlvbihtYXJrZXIpIHtcbiAgICAgICAgbWFya2VyLnNldE1hcChtYXApO1xuICAgICAgICBib3VuZHMuZXh0ZW5kKG1hcmtlci5wb3NpdGlvbik7XG4gICAgfSk7XG4gICAgbWFwLmZpdEJvdW5kcyhib3VuZHMpO1xufVxuXG4vLyBUaGUgZm9sbG93aW5nIGdyb3VwIHVzZXMgdGhlIGxvY2F0aW9uIGFycmF5IHRvIGNyZWF0ZSBhbiBhcnJheSBvZiBtYXJrZXJzIG9uIGluaXRpYWxpemUuXG5mdW5jdGlvbiBnZXRBbGxNYXJrZXJzKGxvY2F0aW9ucykge1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbG9jYXRpb25zLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIC8vIEdldCB0aGUgcG9zaXRpb24gZnJvbSB0aGUgbG9jYXRpb24gYXJyYXkuXG4gICAgICAgIHZhciBwb3NpdGlvbiA9IGxvY2F0aW9uc1tpXS5sb2NhdGlvbjtcbiAgICAgICAgdmFyIHRpdGxlID0gbG9jYXRpb25zW2ldLnRpdGxlO1xuICAgICAgICB2YXIgZ2VucmUgPSBsb2NhdGlvbnNbaV0uZ2VucmU7XG4gICAgICAgIHZhciBjb250ZW50ID0gbG9jYXRpb25zW2ldLmFqYXhDb250ZW50ID0ga28ub2JzZXJ2YWJsZSgncGVuZGluZyBzZWFyY2guLi4nKTtcbiAgICAgICAgLy8gQ3JlYXRlIGEgbWFya2VyIHBlciBsb2NhdGlvbiwgYW5kIHB1dCBpbnRvIG1hcmtlcnMgYXJyYXkuXG4gICAgICAgIHZhciBtYXJrZXIgPSBuZXcgZ29vZ2xlLm1hcHMuTWFya2VyKHtcbiAgICAgICAgICAgIHBvc2l0aW9uOiBwb3NpdGlvbixcbiAgICAgICAgICAgIHRpdGxlOiB0aXRsZSxcbiAgICAgICAgICAgIGdlbnJlOiBnZW5yZSxcbiAgICAgICAgICAgIGFqYXhDb250ZW50OiBjb250ZW50LFxuICAgICAgICAgICAgYW5pbWF0aW9uOiBnb29nbGUubWFwcy5BbmltYXRpb24uRFJPUCxcbiAgICAgICAgICAgIGlkOiBpXG4gICAgICAgIH0pO1xuXG4gICAgICAgIGluZm93aW5kb3cgPSBuZXcgZ29vZ2xlLm1hcHMuSW5mb1dpbmRvdygpO1xuXG4gICAgICAgIC8vIFB1c2ggdGhlIG1hcmtlciB0byBvdXIgYXJyYXkgb2YgbWFya2Vycy5cbiAgICAgICAgbWFya2Vycy5wdXNoKG1hcmtlcik7XG4gICAgICAgIC8vIENyZWF0ZSBhbiBvbmNsaWNrIGV2ZW50IHRvIG9wZW4gYW4gaW5mb3dpbmRvdyBhdCBlYWNoIG1hcmtlci5cbiAgICAgICAgbWFya2VyLmFkZExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgZ2V0RlModGhpcyk7XG4gICAgICAgICAgICBwb3B1bGF0ZUluZm9XaW5kb3codGhpcywgaW5mb3dpbmRvdyk7XG4gICAgICAgICAgICB0b2dnbGVCb3VuY2UodGhpcyk7XG5cbiAgICAgICAgfSk7XG5cbiAgICB9XG59XG4vLyBjb25zb2xlLmxvZyhtYXJrZXJzKCkpO1xuXG5mdW5jdGlvbiBnZXRGUyhtYXJrZXIpIHtcbiAgICAvLyBCRUdJTiBGT1VSU1FVQVJFIEFKQVggSU5JVFxuICAgIHZhciB1cmwgPSBcImh0dHBzOi8vYXBpLmZvdXJzcXVhcmUuY29tL3YyL3ZlbnVlcy9leHBsb3JlXCI7XG4gICAgLy9mb3Vyc3F1YXJlIGNsaWVudCBJRFxuICAgIHZhciBpZEZTcSA9ICdDQUQzRUVYTU5IUUZKNEhEMjE1RDRFQTBLQjEwV0hRR1hTUlFDVjJMRk9HRlNGQ0YnO1xuICAgIC8vZm91cnNxdWFyZSBjbGllbnQgU2VjcmV0XG4gICAgdmFyIHNlY3JldEZzcSA9ICdXTjRVWE5TU01SMjVTTk9NVDVWQ0VCV1ZWT05GUTRIVUJHUVpaM0RMREkxVDVPNUYnO1xuICAgIC8vY29uc29sZS5sb2cobWFya2VyLnBvc2l0aW9uKTtcbiAgICAkLmFqYXgoe1xuICAgICAgICB1cmw6IHVybCxcbiAgICAgICAgZGF0YVR5cGU6ICdqc29uJyxcbiAgICAgICAgZGF0YTogXCJsaW1pdD0xJmxsPVwiICsgbWFya2VyLnBvc2l0aW9uLmxhdCgpICsgXCIsXCIgKyBtYXJrZXIucG9zaXRpb24ubG5nKCkgKyBcIiZxdWVyeT1cIiArIG1hcmtlci50aXRsZSArIFwiJlwiICsgXCJjbGllbnRfaWQ9XCIgKyBpZEZTcSArXG4gICAgICAgICAgICBcIiZjbGllbnRfc2VjcmV0PVwiICsgc2VjcmV0RnNxICsgXCImdj0yMDE2MTEwNiZtPWZvdXJzcXVhcmVcIixcbiAgICAgICAgbWV0aG9kOiAnR0VUJyxcbiAgICAgICAgYXN5bmM6IHRydWUsXG4gICAgfSkuZG9uZShmdW5jdGlvbihyZXN1bHQpIHtcblxuICAgICAgICAvL2NhbGxiYWNrIGZ1bmN0aW9uIGlmIHN1Y2NlcyAtIFdpbGwgYWRkIHRoZSByYXRpbmcgcmVjZWl2ZWQgZnJvbSBmb3Vyc3F1YXJlIHRvIHRoZSBjb250ZW50IG9mIHRoZSBpbmZvIHdpbmRvd1xuICAgICAgICBtYXJrZXIucmF0aW5nID0gcmVzdWx0LnJlc3BvbnNlLmdyb3Vwc1swXS5pdGVtc1swXS52ZW51ZS5yYXRpbmc7XG5cbiAgICAgICAgaWYgKCFtYXJrZXIucmF0aW5nKSB7XG4gICAgICAgICAgICBtYXJrZXIucmF0aW5nID0gJ05vIHJhdGluZyBpbiBmb3Vyc3F1YXJlJztcbiAgICAgICAgfVxuXG4gICAgICAgIHZhciBjb250ZW50ID0gJzxicj48ZGl2IGNsYXNzPVwibGFiZWxzXCI+JyArICc8ZGl2IGNsYXNzPVwidGl0bGVcIj4nICsgbWFya2VyLnRpdGxlICtcbiAgICAgICAgICAgICc8L2Rpdj48ZGl2IGNsYXNzPVwicmF0aW5nXCI+Rm91cnNxdWFyZSByYXRpbmc6ICcgKyBtYXJrZXIucmF0aW5nICsgJzwvZGl2PicgKyAnPC9kaXY+JztcbiAgICAgICAgbWFya2VyLmFqYXhDb250ZW50KGNvbnRlbnQpO1xuXG4gICAgfSkuZmFpbChmdW5jdGlvbihlcnIpIHtcblxuICAgICAgICBhbGVydChcIkNvdWxkIG5vdCBsb2FkIGRhdGEgZnJvbSBmb3Vyc3F1YXJlIVwiKTtcbiAgICB9KTtcblxuICAgIC8vIEVORCBGT1VSU1FVQVJFIEFKQVhcbn1cblxuXG4vLyBTZXQgYW5pbWF0aW9uIFxuZnVuY3Rpb24gdG9nZ2xlQm91bmNlKG1hcmtlcikge1xuICAgIGlmIChtYXJrZXIuZ2V0QW5pbWF0aW9uKCkgIT09IG51bGwpIHtcbiAgICAgICAgbWFya2VyLnNldEFuaW1hdGlvbihudWxsKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICBtYXJrZXIuc2V0QW5pbWF0aW9uKGdvb2dsZS5tYXBzLkFuaW1hdGlvbi5CT1VOQ0UpO1xuICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgbWFya2VyLnNldEFuaW1hdGlvbihudWxsKTtcbiAgICAgICAgfSwgNzAwKTtcbiAgICB9XG59XG4vLyBUaGlzIGZ1bmN0aW9uIHBvcHVsYXRlcyB0aGUgaW5mb3dpbmRvdyB3aGVuIHRoZSBtYXJrZXIgaXMgY2xpY2tlZC4gV2UnbGwgb25seSBhbGxvd1xuLy8gb25lIGluZm93aW5kb3cgd2hpY2ggd2lsbCBvcGVuIGF0IHRoZSBtYXJrZXIgdGhhdCBpcyBjbGlja2VkLCBhbmQgcG9wdWxhdGUgYmFzZWRcbi8vIG9uIHRoYXQgbWFya2VycyBwb3NpdGlvbi5cbmZ1bmN0aW9uIHBvcHVsYXRlSW5mb1dpbmRvdyhtYXJrZXIsIGluZm93aW5kb3cpIHtcbiAgICAvLyBDaGVjayB0byBtYWtlIHN1cmUgdGhlIGluZm93aW5kb3cgaXMgbm90IGFscmVhZHkgb3BlbmVkIG9uIHRoaXMgbWFya2VyLlxuICAgIGlmIChpbmZvd2luZG93Lm1hcmtlciAhPSBtYXJrZXIpIHtcbiAgICAgICAgaW5mb3dpbmRvdy5tYXJrZXIgPSBtYXJrZXI7XG4gICAgICAgIGluZm93aW5kb3cuc2V0Q29udGVudCgnPGRpdj4nICsgbWFya2VyLmFqYXhDb250ZW50KCkgKyAnPC9kaXY+Jyk7XG4gICAgICAgIGluZm93aW5kb3cub3BlbihtYXAsIG1hcmtlcik7XG4gICAgICAgIC8vIE1ha2Ugc3VyZSB0aGUgbWFya2VyIHByb3BlcnR5IGlzIGNsZWFyZWQgaWYgdGhlIGluZm93aW5kb3cgaXMgY2xvc2VkLlxuICAgICAgICBpbmZvd2luZG93LmFkZExpc3RlbmVyKCdjbG9zZWNsaWNrJywgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBpbmZvd2luZG93Lm1hcmtlciA9IG51bGw7XG4gICAgICAgIH0pO1xuICAgIH1cbn0iLCIvL1ZpZXdNb2RlbFxuXG5mdW5jdGlvbiBWaWV3TW9kZWwoKSB7XG4gICAgdmFyIHNlbGYgPSB0aGlzO1xuXG4gICAgc2VsZi5saXN0ID0ga28ub2JzZXJ2YWJsZUFycmF5KGRhdGFBcnJheSk7XG4gICAgc2VsZi5jdXJyZW50RmlsdGVyID0ga28ub2JzZXJ2YWJsZSgpO1xuICAgIHNlbGYuZmlsdGVycyA9IGtvLm9ic2VydmFibGVBcnJheShbMCwgMV0pO1xuICAgIHNlbGYuZmlsdGVyID0ga28ub2JzZXJ2YWJsZSgnJyk7XG5cbiAgICBzZWxmLmxvY2F0aW9uU2VsZWN0ID0gZnVuY3Rpb24obG9jKSB7XG4gICAgICAgIGdvb2dsZS5tYXBzLmV2ZW50LnRyaWdnZXIobG9jLCAnY2xpY2snKTtcbiAgICB9O1xuXG4gICAgc2VsZi5maWx0ZXJlZEl0ZW1zID0ga28uY29tcHV0ZWQoZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBmaWx0ZXIgPSBzZWxmLmZpbHRlcigpO1xuICAgICAgICBpZiAoIWZpbHRlciB8fCBmaWx0ZXIgPT09IDApIHtcblxuICAgICAgICAgICAgLy8gU0hPVyBBTEwgTUFSS0VSUyBXSEVOIEZJTFRFUiBSRVNFVFNcbiAgICAgICAgICAgIG1hcmtlcnMoKS5mb3JFYWNoKGZ1bmN0aW9uKG1hcmtlcikge1xuICAgICAgICAgICAgICAgIG1hcmtlci5zZXRWaXNpYmxlKHRydWUpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZXR1cm4gbWFya2VycygpO1xuXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4ga28udXRpbHMuYXJyYXlGaWx0ZXIobWFya2VycygpLCBmdW5jdGlvbihpKSB7XG4gICAgICAgICAgICAgICAgLy8gQ1JFQVRFIE1BVENIIFZBUklBQkxFIFRPIFVTRSBUTyBTRVQgTUFSS0VSIFZJU0lCSUxJVFlcbiAgICAgICAgICAgICAgICB2YXIgbWF0Y2ggPSBpLmdlbnJlID09IGZpbHRlcjtcbiAgICAgICAgICAgICAgICBpLnNldFZpc2libGUobWF0Y2gpO1xuICAgICAgICAgICAgICAgIC8vY2xvc2UgYW55IG9wZW4gaW5mb3dpbmRvd3NcbiAgICAgICAgICAgICAgICBpZiAoaW5mb3dpbmRvdykge1xuICAgICAgICAgICAgICAgICAgICBpbmZvd2luZG93LmNsb3NlKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiBtYXRjaDtcblxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9KTtcblxuXG59XG5cbi8vIEFjdGl2YXRlcyBrbm9ja291dC5qc1xua28uYXBwbHlCaW5kaW5ncyhuZXcgVmlld01vZGVsKCkpOyIsInZhciBkYXRhQXJyYXkgPSBbe1xuICAgIHRpdGxlOiAnUGFyayBBdmUgUGVudGhvdXNlJyxcbiAgICBsb2NhdGlvbjoge1xuICAgICAgICBsYXQ6IDQwLjc3MTMwMjQsXG4gICAgICAgIGxuZzogLTczLjk2MzIzOTNcbiAgICB9LFxuICAgIGdlbnJlOiAnMSdcbn0sIHtcbiAgICB0aXRsZTogJ0NoZWxzZWEgTG9mdCcsXG4gICAgbG9jYXRpb246IHtcbiAgICAgICAgbGF0OiA0MC43NDQ0ODgzLFxuICAgICAgICBsbmc6IC03My45OTQ5NDY1XG4gICAgfSxcbiAgICBnZW5yZTogJzAnXG59LCB7XG4gICAgdGl0bGU6ICdVbmlvbiBTcXVhcmUgT3BlbiBGbG9vciBQbGFuJyxcbiAgICBsb2NhdGlvbjoge1xuICAgICAgICBsYXQ6IDQwLjczNDcwNjIsXG4gICAgICAgIGxuZzogLTczLjk4OTU3NTlcbiAgICB9LFxuICAgIGdlbnJlOiAnMSdcbn0sIHtcbiAgICB0aXRsZTogJ0Vhc3QgVmlsbGFnZSBIaXAgU3R1ZGlvJyxcbiAgICBsb2NhdGlvbjoge1xuICAgICAgICBsYXQ6IDQwLjcyODE3NzcsXG4gICAgICAgIGxuZzogLTczLjk4NDM3N1xuICAgIH0sXG4gICAgZ2VucmU6ICcwJ1xufSwge1xuICAgIHRpdGxlOiAnVHJpQmVDYSBBcnRzeSBCYWNoZWxvciBQYWQnLFxuICAgIGxvY2F0aW9uOiB7XG4gICAgICAgIGxhdDogNDAuNzE5NTI2NCxcbiAgICAgICAgbG5nOiAtNzQuMDA4OTkzNFxuICAgIH0sXG4gICAgZ2VucmU6ICcxJ1xufSwge1xuICAgIHRpdGxlOiAnQ2hpbmF0b3duIEhvbWV5IFNwYWNlJyxcbiAgICBsb2NhdGlvbjoge1xuICAgICAgICBsYXQ6IDQwLjcxODA2MjgsXG4gICAgICAgIGxuZzogLTczLjk5NjEyMzdcbiAgICB9LFxuICAgIGdlbnJlOiAnMCdcbn1dOyJdfQ==
